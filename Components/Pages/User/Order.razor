@page "/order"
@attribute [Authorize]

<div class="container mx-auto p-4 sm:p-6 lg:p-8">
    <h1 class="text-2xl font-bold text-gray-900 mb-6">Đơn Hàng</h1>

    @if (orders == null)
    {
        <p>Loading orders...</p>
    }
    else
    {
        <div class="overflow-x-auto bg-white rounded-lg shadow">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Product</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Order</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                        <th scope="col" class="relative px-6 py-3">
                            <span class="sr-only">View</span>
                        </th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    @foreach (var order in orders)
                    {
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0 h-10 w-10">
                                        <img class="h-10 w-10 rounded-full object-contain" src="@order.ProductImage" alt="">
                                    </div>
                                    <div class="ml-4">
                                        <div class="text-sm font-medium text-gray-900">@order.ProductName</div>
                                        <div class="text-sm text-gray-500">@order.ProductDescription</div>
                                    </div>
                                </div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-900">#@order.OrderId</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <div class="text-sm text-gray-500">@order.OrderDate.ToString("MMM dd, yyyy")</div>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full @GetStatusClass(order.Status)">
                                    @order.Status
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium">
                                @order.Amount.ToString("C")
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                <a href="#" class="text-indigo-600 hover:text-indigo-900">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                    </svg>
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    }
</div>

@code {
    private List<OrderModel> orders;

    public enum OrderStatus { Pending, Paid, Canceled }

    public class OrderModel
    {
        public string ProductImage { get; set; }
        public string ProductName { get; set; }
        public string ProductDescription { get; set; }
        public int OrderId { get; set; }
        public DateTime OrderDate { get; set; }
        public OrderStatus Status { get; set; }
        public decimal Amount { get; set; }
    }

    protected override void OnInitialized()
    {
        // Dữ liệu mẫu - Thay thế bằng lệnh gọi API thực tế
        orders = new List<OrderModel>
        {
            new OrderModel { ProductImage = "https://i.imgur.com/Jz5lQYx.png", ProductName = "Coca Cola Lon", ProductDescription = "330ml", OrderId = 14899, OrderDate = new DateTime(2023, 3, 5), Status = OrderStatus.Pending, Amount = 15.00m },
            new OrderModel { ProductImage = "https://i.imgur.com/sUT8SgE.png", ProductName = "Pepsi Lon", ProductDescription = "330ml", OrderId = 14658, OrderDate = new DateTime(2023, 7, 9), Status = OrderStatus.Paid, Amount = 45.00m },
            new OrderModel { ProductImage = "https://i.imgur.com/r33a2dJ.png", ProductName = "Bánh Chocopie", ProductDescription = "Hộp 12 cái", OrderId = 13778, OrderDate = new DateTime(2023, 10, 3), Status = OrderStatus.Paid, Amount = 99.00m },
            new OrderModel { ProductImage = "https://i.imgur.com/Jz5lQYx.png", ProductName = "Sting Dâu", ProductDescription = "330ml", OrderId = 13746, OrderDate = new DateTime(2023, 3, 5), Status = OrderStatus.Paid, Amount = 12.00m },
            new OrderModel { ProductImage = "https://i.imgur.com/r33a2dJ.png", ProductName = "Bánh Oreo", ProductDescription = "133g", OrderId = 13566, OrderDate = new DateTime(2023, 7, 9), Status = OrderStatus.Canceled, Amount = 6.00m },
            new OrderModel { ProductImage = "https://i.imgur.com/sUT8SgE.png", ProductName = "Trà Xanh 0 Độ", ProductDescription = "500ml", OrderId = 12094, OrderDate = new DateTime(2023, 10, 3), Status = OrderStatus.Paid, Amount = 18.00m }
        };
    }

    private string GetStatusClass(OrderStatus status)
    {
        return status switch
        {
            OrderStatus.Paid => "bg-green-100 text-green-800",
            OrderStatus.Pending => "bg-yellow-100 text-yellow-800",
            OrderStatus.Canceled => "bg-red-100 text-red-800",
            _ => "bg-gray-100 text-gray-800"
        };
    }
}
